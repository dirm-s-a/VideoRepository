# ============================================================
# Docker Compose - Repositorio Central de Videos
# ============================================================
# Se despliega en UN servidor central de la LAN.
# Los llamadores se conectan via HTTP a este servicio.
#
# Uso:
#   docker compose up -d --build   # Construir y levantar
#   docker compose logs -f         # Ver logs
#   docker compose down            # Apagar
#
# Nginx reverse proxy:
#   videorepository.dim.com.ar → localhost:3002 → container:3000
# ============================================================

services:
  video-repository:
    build:
      context: .
      args:
        JWT_SECRET: ${JWT_SECRET:-video-repo-secret-dim-2026}
    ports:
      - "127.0.0.1:3002:3000"
    volumes:
      # Persistir videos y base de datos SQLite
      - video-data:/app/data
    environment:
      - JWT_SECRET=${JWT_SECRET:-video-repo-secret-dim-2026}
    restart: unless-stopped

volumes:
  video-data:
